# ================================================================================================
# GBMM Platform - Environment Variables Template
# ================================================================================================
# Copy this file to .env and customize the values for your environment
# Development defaults are provided - CHANGE ALL PASSWORDS AND SECRETS FOR PRODUCTION!
# ================================================================================================

# ================================================================================================
# ENVIRONMENT
# ================================================================================================
ENVIRONMENT=development
PROJECT_NAME=gbmm-platform
COMPOSE_PROJECT_NAME=gbmm

# ================================================================================================
# POSTGRESQL - Primary Data Store
# ================================================================================================
POSTGRES_VERSION=15-alpine
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_SUPERUSER=postgres
POSTGRES_SUPERUSER_PASSWORD=postgres_dev_password_change_me

# Database names for each service
UCCP_DB_NAME=uccp_db
NCCS_DB_NAME=nccs_db
USP_DB_NAME=usp_db
UDPS_DB_NAME=udps_db
STREAM_DB_NAME=stream_db

# Service-specific database users
UCCP_DB_USER=uccp_user
UCCP_DB_PASSWORD=uccp_dev_password_change_me

NCCS_DB_USER=nccs_user
NCCS_DB_PASSWORD=nccs_dev_password_change_me

USP_DB_USER=usp_user
USP_DB_PASSWORD=usp_dev_password_change_me

UDPS_DB_USER=udps_user
UDPS_DB_PASSWORD=udps_dev_password_change_me

STREAM_DB_USER=stream_user
STREAM_DB_PASSWORD=stream_dev_password_change_me

# PostgreSQL connection pool settings
POSTGRES_MAX_CONNECTIONS=200
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB
POSTGRES_WORK_MEM=16MB

# ================================================================================================
# REDIS - Cache and Sessions
# ================================================================================================
REDIS_VERSION=7-alpine
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=redis_dev_password_change_me
REDIS_MAX_MEMORY=2gb
REDIS_MAX_MEMORY_POLICY=allkeys-lru
REDIS_PERSISTENCE=yes

# ================================================================================================
# APACHE KAFKA - Event Streaming
# ================================================================================================
KAFKA_VERSION=3.6.0
KAFKA_HOST=kafka
KAFKA_PORT=9092
KAFKA_EXTERNAL_PORT=9093
KAFKA_BROKER_ID=1
KAFKA_AUTO_CREATE_TOPICS=true
KAFKA_NUM_PARTITIONS=3
KAFKA_REPLICATION_FACTOR=1
KAFKA_LOG_RETENTION_HOURS=168

# Zookeeper
ZOOKEEPER_VERSION=3.8.3
ZOOKEEPER_HOST=zookeeper
ZOOKEEPER_PORT=2181
ZOOKEEPER_TICK_TIME=2000

# Kafka Topics
KAFKA_TOPIC_USER_EVENTS=user-events
KAFKA_TOPIC_ORDER_EVENTS=order-events
KAFKA_TOPIC_COMPUTE_EVENTS=compute-events
KAFKA_TOPIC_SECURITY_EVENTS=security-events
KAFKA_TOPIC_DATA_EVENTS=data-events
KAFKA_TOPIC_STREAM_EVENTS=stream-events

# ================================================================================================
# MINIO - Object Storage (S3-Compatible)
# ================================================================================================
MINIO_VERSION=latest
MINIO_HOST=minio
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=minio_admin
MINIO_ROOT_PASSWORD=minio_dev_password_change_me
MINIO_REGION=us-east-1

# MinIO buckets
MINIO_BUCKET_ML_ARTIFACTS=ml-artifacts
MINIO_BUCKET_CHECKPOINTS=checkpoints
MINIO_BUCKET_DATA_LAKE=data-lake
MINIO_BUCKET_BACKUPS=backups
MINIO_BUCKET_LOGS=logs

# ================================================================================================
# RABBITMQ - Message Broker
# ================================================================================================
# Note: Secrets management is provided by USP (Unified Security Platform) service
# USP will be added in docker-compose.yml when services are implemented
# For Phase 0 (infrastructure only), secrets are stored in this .env file
RABBITMQ_VERSION=3.12-management-alpine
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_DEFAULT_USER=rabbitmq_admin
RABBITMQ_DEFAULT_PASS=rabbitmq_dev_password_change_me
RABBITMQ_VHOST=/

# RabbitMQ Exchanges
RABBITMQ_EXCHANGE_EVENTS=gbmm.events
RABBITMQ_EXCHANGE_COMMANDS=gbmm.commands
RABBITMQ_EXCHANGE_QUERIES=gbmm.queries

# ================================================================================================
# PROMETHEUS - Metrics Collection
# ================================================================================================
PROMETHEUS_VERSION=v2.45.0
PROMETHEUS_HOST=prometheus
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION_TIME=30d
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_EVALUATION_INTERVAL=15s

# ================================================================================================
# GRAFANA - Visualization
# ================================================================================================
GRAFANA_VERSION=10.0.0
GRAFANA_HOST=grafana
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=grafana_dev_password_change_me
GRAFANA_ALLOW_SIGN_UP=false
GRAFANA_DISABLE_GRAVATAR=true

# ================================================================================================
# JAEGER - Distributed Tracing
# ================================================================================================
JAEGER_VERSION=1.47
JAEGER_HOST=jaeger
JAEGER_COLLECTOR_PORT=14268
JAEGER_AGENT_PORT=6831
JAEGER_QUERY_PORT=16686
JAEGER_ADMIN_PORT=14269
JAEGER_SAMPLING_RATE=1.0

# ================================================================================================
# ELASTICSEARCH - Log Aggregation
# ================================================================================================
ELASTICSEARCH_VERSION=8.8.0
ELASTICSEARCH_HOST=elasticsearch
ELASTICSEARCH_PORT=9200
ELASTICSEARCH_CLUSTER_NAME=gbmm-logs
ELASTICSEARCH_NODE_NAME=es-node-1
ELASTICSEARCH_DISCOVERY_TYPE=single-node
ELASTICSEARCH_HEAP_SIZE=1g
ELASTICSEARCH_PASSWORD=elastic_dev_password_change_me

# ================================================================================================
# NETWORK CONFIGURATION
# ================================================================================================
# Network CIDR blocks
NETWORK_DMZ_SUBNET=10.0.1.0/24
NETWORK_SERVICE_SUBNET=10.0.10.0/24
NETWORK_DATA_SUBNET=10.0.20.0/24
NETWORK_OBSERVABILITY_SUBNET=10.0.30.0/24

# ================================================================================================
# TLS / SECURITY CONFIGURATION
# ================================================================================================
# Certificate paths (generated by scripts/generate-dev-certs.sh)
CERTS_DIR=./certs
CA_CERT_FILE=${CERTS_DIR}/ca.crt
CA_KEY_FILE=${CERTS_DIR}/ca.key

# TLS settings
TLS_MIN_VERSION=1.3
TLS_CIPHER_SUITES=TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
TLS_VERIFY_CLIENT=true
TLS_VERIFY_DEPTH=1

# JWT settings
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRY=3600
JWT_REFRESH_TOKEN_EXPIRY=86400
JWT_ISSUER=gbmm-platform

# ================================================================================================
# UCCP - Unified Compute & Coordination Platform
# ================================================================================================
UCCP_VERSION=latest
UCCP_HOST=uccp
UCCP_GRPC_PORT=50000
UCCP_HTTPS_PORT=8443
UCCP_RAFT_PORT=50061
UCCP_METRICS_PORT=9100
UCCP_HEALTH_PORT=8080

# UCCP Raft Configuration
UCCP_RAFT_NODE_ID=uccp-node-1
UCCP_RAFT_CLUSTER_SIZE=3
UCCP_RAFT_ELECTION_TIMEOUT=1000
UCCP_RAFT_HEARTBEAT_INTERVAL=500

# UCCP ML Configuration
UCCP_ML_BACKEND=tensorflow
UCCP_ML_GPU_ENABLED=false
UCCP_ML_MODEL_CACHE_SIZE=10GB

# ================================================================================================
# NCCS - .NET Compute Client Service
# ================================================================================================
NCCS_VERSION=latest
NCCS_HOST=nccs
NCCS_HTTPS_PORT=5001
NCCS_GRPC_PORT=5002
NCCS_METRICS_PORT=9200
NCCS_HEALTH_PORT=8080

# NCCS SignalR Configuration
NCCS_SIGNALR_ENABLED=true
NCCS_SIGNALR_KEEPALIVE_INTERVAL=15000
NCCS_SIGNALR_CLIENT_TIMEOUT=30000

# ================================================================================================
# USP - Unified Security Platform
# ================================================================================================
USP_VERSION=latest
USP_HOST=usp
USP_HTTPS_PORT=8443
USP_GRPC_PORT=50005
USP_METRICS_PORT=9090
USP_HEALTH_PORT=8080

# USP Authentication Configuration
USP_AUTH_MFA_ENABLED=true
USP_AUTH_SESSION_TIMEOUT=3600
USP_AUTH_MAX_LOGIN_ATTEMPTS=5
USP_AUTH_LOCKOUT_DURATION=900

# USP Encryption Configuration
USP_ENCRYPTION_ALGORITHM=AES-256-GCM
USP_ENCRYPTION_KEY_ROTATION_DAYS=90

# ================================================================================================
# UDPS - Unified Data Platform Service
# ================================================================================================
UDPS_VERSION=latest
UDPS_HOST=udps
UDPS_GRPC_PORT=50060
UDPS_HTTPS_PORT=8443
UDPS_METRICS_PORT=9090
UDPS_HEALTH_PORT=8081

# UDPS Storage Configuration
UDPS_STORAGE_FORMAT=parquet
UDPS_COMPRESSION_CODEC=snappy
UDPS_PARTITION_SIZE=128MB
UDPS_CACHE_SIZE=4GB

# ================================================================================================
# STREAM COMPUTE - Real-time Stream Processing
# ================================================================================================
STREAM_VERSION=latest
STREAM_HOST=stream-compute
STREAM_GRPC_PORT=50060
STREAM_METRICS_PORT=9096
STREAM_HEALTH_PORT=8082

# Stream Processing Configuration
STREAM_BUFFER_SIZE=10000
STREAM_BATCH_SIZE=1000
STREAM_FLUSH_INTERVAL=5000
STREAM_PARALLELISM=4

# Apache Flink Configuration
FLINK_JOBMANAGER_PORT=8081
FLINK_TASKMANAGER_SLOTS=4
FLINK_PARALLELISM_DEFAULT=4
FLINK_CHECKPOINTING_INTERVAL=60000

# ================================================================================================
# LOGGING CONFIGURATION
# ================================================================================================
LOG_LEVEL=debug
LOG_FORMAT=json
LOG_OUTPUT=stdout
LOG_INCLUDE_CALLER=true
LOG_INCLUDE_STACKTRACE=false

# Service-specific log levels
UCCP_LOG_LEVEL=debug
NCCS_LOG_LEVEL=debug
USP_LOG_LEVEL=info
UDPS_LOG_LEVEL=debug
STREAM_LOG_LEVEL=debug

# ================================================================================================
# RESOURCE LIMITS (Development)
# ================================================================================================
# PostgreSQL
POSTGRES_CPU_LIMIT=2
POSTGRES_MEMORY_LIMIT=4g

# Redis
REDIS_CPU_LIMIT=1
REDIS_MEMORY_LIMIT=2g

# Kafka
KAFKA_CPU_LIMIT=2
KAFKA_MEMORY_LIMIT=4g
KAFKA_HEAP_OPTS=-Xmx2g -Xms2g

# MinIO
MINIO_CPU_LIMIT=1
MINIO_MEMORY_LIMIT=2g

# RabbitMQ
RABBITMQ_CPU_LIMIT=2
RABBITMQ_MEMORY_LIMIT=2g

# Services
UCCP_CPU_LIMIT=2
UCCP_MEMORY_LIMIT=4g

NCCS_CPU_LIMIT=1
NCCS_MEMORY_LIMIT=2g

USP_CPU_LIMIT=1
USP_MEMORY_LIMIT=2g

UDPS_CPU_LIMIT=2
UDPS_MEMORY_LIMIT=4g

STREAM_CPU_LIMIT=2
STREAM_MEMORY_LIMIT=4g

# ================================================================================================
# DEVELOPMENT TOOLS
# ================================================================================================
# Enable development features
DEV_MODE=true
DEV_CORS_ENABLED=true
DEV_CORS_ORIGINS=*
DEV_HOT_RELOAD=true
DEV_DEBUG_PORT_UCCP=2345
DEV_DEBUG_PORT_NCCS=5000
DEV_DEBUG_PORT_USP=5003
DEV_DEBUG_PORT_UDPS=5005
DEV_DEBUG_PORT_STREAM=5006

# ================================================================================================
# BACKUP CONFIGURATION
# ================================================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=true
BACKUP_ENCRYPTION=true

# ================================================================================================
# HEALTHCHECK CONFIGURATION
# ================================================================================================
HEALTHCHECK_INTERVAL=30s
HEALTHCHECK_TIMEOUT=10s
HEALTHCHECK_RETRIES=3
HEALTHCHECK_START_PERIOD=60s

# ================================================================================================
# NOTES
# ================================================================================================
# 1. Copy this file to .env: cp .env.template .env
# 2. Update all passwords and secrets (search for "change_me")
# 3. For production, set ENVIRONMENT=production and update all security settings
# 4. Generate certificates: make setup-certs
# 5. Initialize databases: make setup-databases
# 6. Start infrastructure: make infra-up
# 7. Run smoke tests: make smoke-test
#
# Secrets Management:
# - Phase 0 (Infrastructure only): Secrets stored in this .env file
# - Phase 1 (Service development): Secrets in secrets/dev-secrets.json
# - Phase 2+: USP (Unified Security Platform) provides Vault-compatible API
# ================================================================================================
