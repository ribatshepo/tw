// <auto-generated />
using System;
using System.Collections.Generic;
using System.Net;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
using Npgsql.EntityFrameworkCore.PostgreSQL.Metadata;
using USP.Infrastructure.Data;

#nullable disable

namespace USP.Infrastructure.Migrations
{
    [DbContext(typeof(ApplicationDbContext))]
    [Migration("20251226105040_AddPlaybackFieldsToPrivilegedSession")]
    partial class AddPlaybackFieldsToPrivilegedSession
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.22")
                .HasAnnotation("Relational:MaxIdentifierLength", 63);

            NpgsqlModelBuilderExtensions.UseIdentityByDefaultColumns(modelBuilder);

            modelBuilder.Entity("USP.Core.Models.Entities.AccessApproval", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("ApprovalPolicy")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("approval_policy");

                    b.Property<DateTime?>("ApprovedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("approved_at");

                    b.Property<List<Guid>>("ApprovedBy")
                        .IsRequired()
                        .HasColumnType("jsonb")
                        .HasColumnName("approved_by");

                    b.Property<List<Guid>>("Approvers")
                        .IsRequired()
                        .HasColumnType("jsonb")
                        .HasColumnName("approvers");

                    b.Property<int>("CurrentApprovals")
                        .HasColumnType("integer")
                        .HasColumnName("current_approvals");

                    b.Property<string>("DenialReason")
                        .HasColumnType("text")
                        .HasColumnName("denial_reason");

                    b.Property<DateTime?>("DeniedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("denied_at");

                    b.Property<string>("DeniedBy")
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("denied_by");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Reason")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("reason");

                    b.Property<DateTime>("RequestedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("requested_at");

                    b.Property<Guid>("RequesterId")
                        .HasColumnType("uuid")
                        .HasColumnName("requester_id");

                    b.Property<int>("RequiredApprovals")
                        .HasColumnType("integer")
                        .HasColumnName("required_approvals");

                    b.Property<Guid>("ResourceId")
                        .HasColumnType("uuid")
                        .HasColumnName("resource_id");

                    b.Property<string>("ResourceType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("resource_type");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.HasKey("Id");

                    b.HasIndex("ExpiresAt")
                        .HasDatabaseName("idx_access_approvals_expires_at");

                    b.HasIndex("RequesterId")
                        .HasDatabaseName("idx_access_approvals_requester_id");

                    b.HasIndex("ResourceType")
                        .HasDatabaseName("idx_access_approvals_resource_type");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_access_approvals_status");

                    b.ToTable("access_approvals", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AccessPolicy", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string[]>("Actions")
                        .HasColumnType("text[]")
                        .HasColumnName("actions");

                    b.Property<string>("Conditions")
                        .HasColumnType("jsonb")
                        .HasColumnName("conditions");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<string>("Description")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("description");

                    b.Property<string>("Effect")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("effect");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean")
                        .HasColumnName("is_active");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<string>("Policy")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("policy");

                    b.Property<string>("PolicyType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("policy_type");

                    b.Property<int>("Priority")
                        .HasColumnType("integer")
                        .HasColumnName("priority");

                    b.Property<string>("Resources")
                        .HasColumnType("jsonb")
                        .HasColumnName("resources");

                    b.Property<string>("Subjects")
                        .HasColumnType("jsonb")
                        .HasColumnName("subjects");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.HasIndex("IsActive")
                        .HasDatabaseName("idx_access_policies_is_active");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("idx_access_policies_name");

                    b.HasIndex("PolicyType")
                        .HasDatabaseName("idx_access_policies_policy_type");

                    b.ToTable("access_policies", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AccountCheckout", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("AccountId")
                        .HasColumnType("uuid")
                        .HasColumnName("account_id");

                    b.Property<Guid?>("ApprovalId")
                        .HasColumnType("uuid")
                        .HasColumnName("approval_id");

                    b.Property<bool>("ApprovalRequired")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("CheckedInAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("checked_in_at");

                    b.Property<DateTime>("CheckedOutAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("checked_out_at");

                    b.Property<DateTime>("CheckoutTime")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<string>("IpAddress")
                        .HasColumnType("text")
                        .HasColumnName("ip_address");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Reason")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("reason");

                    b.Property<bool>("RotateOnCheckin")
                        .HasColumnType("boolean")
                        .HasColumnName("rotate_on_checkin");

                    b.Property<string>("SessionRecordingPath")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("session_recording_path");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text")
                        .HasColumnName("user_agent");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.Property<bool>("WasRotated")
                        .HasColumnType("boolean")
                        .HasColumnName("was_rotated");

                    b.HasKey("Id");

                    b.HasIndex("AccountId")
                        .HasDatabaseName("idx_account_checkouts_account_id");

                    b.HasIndex("ApprovalId");

                    b.HasIndex("ExpiresAt")
                        .HasDatabaseName("idx_account_checkouts_expires_at");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_account_checkouts_status");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_account_checkouts_user_id");

                    b.ToTable("account_checkouts", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ApiKey", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("Description")
                        .HasColumnType("text");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<string>("KeyHash")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("key_hash");

                    b.Property<string>("KeyPrefix")
                        .IsRequired()
                        .HasMaxLength(20)
                        .HasColumnType("character varying(20)")
                        .HasColumnName("key_prefix");

                    b.Property<DateTime?>("LastUsedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_used_at");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<int?>("RateLimitPerDay")
                        .HasColumnType("integer");

                    b.Property<int?>("RateLimitPerHour")
                        .HasColumnType("integer");

                    b.Property<int?>("RateLimitPerMinute")
                        .HasColumnType("integer");

                    b.Property<int>("RequestCount")
                        .HasColumnType("integer");

                    b.Property<bool>("Revoked")
                        .HasColumnType("boolean")
                        .HasColumnName("revoked");

                    b.Property<DateTime?>("RevokedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("revoked_at");

                    b.Property<string[]>("Scopes")
                        .IsRequired()
                        .HasColumnType("text[]")
                        .HasColumnName("scopes");

                    b.Property<string>("SigningSecret")
                        .HasColumnType("text");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.HasKey("Id");

                    b.HasIndex("KeyHash")
                        .IsUnique()
                        .HasDatabaseName("idx_api_keys_key_hash");

                    b.HasIndex("Revoked")
                        .HasDatabaseName("idx_api_keys_revoked");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_api_keys_user_id");

                    b.ToTable("api_keys", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ApplicationUser", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("Email")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("email");

                    b.Property<int>("FailedLoginAttempts")
                        .HasColumnType("integer")
                        .HasColumnName("failed_login_attempts");

                    b.Property<string>("FirstName")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("first_name");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("LastFailedLogin")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_failed_login");

                    b.Property<DateTime?>("LastLoginAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("LastName")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("last_name");

                    b.Property<DateTime?>("LockedUntil")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("locked_until");

                    b.Property<string>("Metadata")
                        .HasColumnType("text");

                    b.Property<bool>("MfaEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("mfa_enabled");

                    b.Property<string>("MfaSecret")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("mfa_secret");

                    b.Property<DateTime?>("PasswordChangedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("password_changed_at");

                    b.Property<string>("PasswordHash")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("password_hash");

                    b.Property<bool>("PhoneNumberVerified")
                        .HasColumnType("boolean");

                    b.Property<string>("RiskProfile")
                        .HasColumnType("text");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<string>("UserName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("username");

                    b.Property<string>("VerifiedPhoneNumber")
                        .HasColumnType("text");

                    b.HasKey("Id");

                    b.HasIndex("Email")
                        .HasDatabaseName("idx_users_email");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_users_status");

                    b.HasIndex("UserName")
                        .HasDatabaseName("idx_users_username");

                    b.ToTable("users", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AuditLog", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Action")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("action");

                    b.Property<string>("CorrelationId")
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("correlation_id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("CurrentHash")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("current_hash");

                    b.Property<int>("DurationMs")
                        .HasColumnType("integer");

                    b.Property<string>("ErrorMessage")
                        .HasColumnType("text")
                        .HasColumnName("error_message");

                    b.Property<string>("HttpMethod")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("IpAddress")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("ip_address");

                    b.Property<string>("Metadata")
                        .HasColumnType("text");

                    b.Property<string>("NewValue")
                        .HasColumnType("text")
                        .HasColumnName("new_value");

                    b.Property<string>("OldValue")
                        .HasColumnType("text")
                        .HasColumnName("old_value");

                    b.Property<string>("PreviousHash")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("previous_hash");

                    b.Property<string>("QueryString")
                        .HasColumnType("text");

                    b.Property<string>("RequestBody")
                        .HasColumnType("text");

                    b.Property<string>("RequestPath")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("Resource")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("ResourceId")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("resource_id");

                    b.Property<string>("ResourceType")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("resource_type");

                    b.Property<string>("ResponseBody")
                        .HasColumnType("text");

                    b.Property<int>("ResponseStatus")
                        .HasColumnType("integer");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<bool>("Success")
                        .HasColumnType("boolean");

                    b.Property<DateTime>("Timestamp")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text")
                        .HasColumnName("user_agent");

                    b.Property<Guid?>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasColumnType("text");

                    b.HasKey("Id");

                    b.HasIndex("Action")
                        .HasDatabaseName("idx_audit_logs_action");

                    b.HasIndex("CorrelationId")
                        .HasDatabaseName("idx_audit_logs_correlation_id");

                    b.HasIndex("CreatedAt")
                        .HasDatabaseName("idx_audit_logs_created_at");

                    b.HasIndex("ResourceType")
                        .HasDatabaseName("idx_audit_logs_resource_type");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_audit_logs_user_id");

                    b.ToTable("audit_logs", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AuthorizationFlow", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("Action")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("ApproverRoles")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Description")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("FlowName")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<int>("RequiredApprovals")
                        .HasColumnType("integer");

                    b.Property<string>("ResourceType")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id");

                    b.ToTable("AuthorizationFlows");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AuthorizationFlowInstance", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("Action")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime?>("CompletedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Context")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("FlowId")
                        .HasColumnType("uuid");

                    b.Property<Guid>("RequesterId")
                        .HasColumnType("uuid");

                    b.Property<string>("ResourceId")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("ResourceType")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasColumnType("text");

                    b.HasKey("Id");

                    b.HasIndex("FlowId");

                    b.HasIndex("RequesterId");

                    b.ToTable("AuthorizationFlowInstances");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.BreakGlassAccess", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("AccessedResources")
                        .HasColumnType("text")
                        .HasColumnName("accessed_resources");

                    b.Property<string>("ActionsPerformed")
                        .HasColumnType("text")
                        .HasColumnName("actions_performed");

                    b.Property<DateTime>("ActivatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("activated_at");

                    b.Property<DateTime?>("DeactivatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("deactivated_at");

                    b.Property<string>("DeviceFingerprint")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("device_fingerprint");

                    b.Property<int>("DurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("duration_minutes");

                    b.Property<bool>("ExecutiveNotified")
                        .HasColumnType("boolean")
                        .HasColumnName("executive_notified");

                    b.Property<DateTime?>("ExecutiveNotifiedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("executive_notified_at");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<string>("IncidentType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("incident_type");

                    b.Property<string>("IpAddress")
                        .HasColumnType("text")
                        .HasColumnName("ip_address");

                    b.Property<string>("Justification")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("Location")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("location");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("NotifiedExecutives")
                        .HasColumnType("text")
                        .HasColumnName("notified_executives");

                    b.Property<string>("Reason")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("reason");

                    b.Property<bool>("RequiresReview")
                        .HasColumnType("boolean")
                        .HasColumnName("requires_review");

                    b.Property<string>("ReviewDecision")
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("review_decision");

                    b.Property<string>("ReviewNotes")
                        .HasColumnType("text")
                        .HasColumnName("review_notes");

                    b.Property<DateTime?>("ReviewedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("reviewed_at");

                    b.Property<Guid?>("ReviewedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("reviewed_by");

                    b.Property<Guid?>("SessionId")
                        .HasColumnType("uuid")
                        .HasColumnName("session_id");

                    b.Property<bool>("SessionRecordingMandatory")
                        .HasColumnType("boolean")
                        .HasColumnName("session_recording_mandatory");

                    b.Property<string>("Severity")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("severity");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text")
                        .HasColumnName("user_agent");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.HasKey("Id");

                    b.HasIndex("ActivatedAt")
                        .HasDatabaseName("idx_break_glass_accesses_activated_at");

                    b.HasIndex("ExpiresAt")
                        .HasDatabaseName("idx_break_glass_accesses_expires_at");

                    b.HasIndex("IncidentType")
                        .HasDatabaseName("idx_break_glass_accesses_incident_type");

                    b.HasIndex("RequiresReview")
                        .HasDatabaseName("idx_break_glass_accesses_requires_review");

                    b.HasIndex("ReviewedBy");

                    b.HasIndex("SessionId");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_break_glass_accesses_status");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_break_glass_accesses_user_id");

                    b.ToTable("break_glass_accesses", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.BreakGlassPolicy", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("AllowedIncidentTypes")
                        .HasColumnType("text")
                        .HasColumnName("allowed_incident_types");

                    b.Property<bool>("AutoNotifyExecutives")
                        .HasColumnType("boolean")
                        .HasColumnName("auto_notify_executives");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<int>("DefaultDurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("default_duration_minutes");

                    b.Property<string>("Description")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<bool>("Enabled")
                        .HasColumnType("boolean")
                        .HasColumnName("enabled");

                    b.Property<string>("ExecutiveUserIds")
                        .HasColumnType("text")
                        .HasColumnName("executive_user_ids");

                    b.Property<bool>("MandatorySessionRecording")
                        .HasColumnType("boolean")
                        .HasColumnName("mandatory_session_recording");

                    b.Property<int>("MaxDurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("max_duration_minutes");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<int>("MinJustificationLength")
                        .HasColumnType("integer")
                        .HasColumnName("min_justification_length");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<string>("NotificationChannels")
                        .HasColumnType("text")
                        .HasColumnName("notification_channels");

                    b.Property<bool>("RequireJustification")
                        .HasColumnType("boolean")
                        .HasColumnName("require_justification");

                    b.Property<bool>("RequirePostAccessReview")
                        .HasColumnType("boolean")
                        .HasColumnName("require_post_access_review");

                    b.Property<string>("RestrictedToRoles")
                        .HasColumnType("text")
                        .HasColumnName("restricted_to_roles");

                    b.Property<int>("ReviewRequiredWithinHours")
                        .HasColumnType("integer")
                        .HasColumnName("review_required_within_hours");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.HasIndex("Enabled")
                        .HasDatabaseName("idx_break_glass_policies_enabled");

                    b.HasIndex("Name")
                        .HasDatabaseName("idx_break_glass_policies_name");

                    b.ToTable("break_glass_policies", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.BusinessAssociateAgreement", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("ComplianceNotes")
                        .HasColumnType("text")
                        .HasColumnName("compliance_notes");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("DocumentHash")
                        .HasMaxLength(128)
                        .HasColumnType("character varying(128)")
                        .HasColumnName("document_hash");

                    b.Property<string>("DocumentPath")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("document_path");

                    b.Property<string>("DocumentUrl")
                        .HasMaxLength(2000)
                        .HasColumnType("character varying(2000)")
                        .HasColumnName("document_url");

                    b.Property<DateTime>("EffectiveDate")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("effective_date");

                    b.Property<DateTime>("ExpirationDate")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expiration_date");

                    b.Property<DateTime?>("LastReviewedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_reviewed_at");

                    b.Property<Guid?>("LastReviewedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("last_reviewed_by");

                    b.Property<int>("NotifyDaysBeforeExpiration")
                        .HasColumnType("integer")
                        .HasColumnName("notify_days_before_expiration");

                    b.Property<string>("PartnerContactEmail")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("partner_contact_email");

                    b.Property<string>("PartnerContactPhone")
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("partner_contact_phone");

                    b.Property<string>("PartnerId")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("partner_id");

                    b.Property<string>("PartnerName")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("partner_name");

                    b.Property<string>("PhiCategories")
                        .HasColumnType("text")
                        .HasColumnName("phi_categories");

                    b.Property<DateTime?>("RenewalCompletedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("renewal_completed_at");

                    b.Property<DateTime?>("RenewalRequestedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("renewal_requested_at");

                    b.Property<bool>("RequiresAnnualReview")
                        .HasColumnType("boolean")
                        .HasColumnName("requires_annual_review");

                    b.Property<string>("ReviewNotes")
                        .HasColumnType("text")
                        .HasColumnName("review_notes");

                    b.Property<string>("ServicesProvided")
                        .HasColumnType("text")
                        .HasColumnName("services_provided");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.HasIndex("ExpirationDate")
                        .HasDatabaseName("idx_baa_expiration_date");

                    b.HasIndex("LastReviewedBy");

                    b.HasIndex("PartnerId")
                        .HasDatabaseName("idx_baa_partner_id");

                    b.HasIndex("PartnerName")
                        .HasDatabaseName("idx_baa_partner_name");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_baa_status");

                    b.HasIndex("Status", "ExpirationDate")
                        .HasDatabaseName("idx_baa_status_expiration");

                    b.ToTable("business_associate_agreements", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ColumnSecurityRule", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string[]>("AllowedRoles")
                        .HasColumnType("text[]");

                    b.Property<string>("ColumnName")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)");

                    b.Property<string>("Condition")
                        .HasColumnType("text");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid");

                    b.Property<string[]>("DeniedRoles")
                        .HasColumnType("text[]");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true);

                    b.Property<string>("MaskingPattern")
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)");

                    b.Property<string>("Operation")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)");

                    b.Property<int>("Priority")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0);

                    b.Property<string>("RestrictionType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)");

                    b.Property<string>("TableName")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id");

                    b.HasIndex("IsActive")
                        .HasDatabaseName("IX_ColumnSecurityRules_IsActive");

                    b.HasIndex("TableName", "ColumnName", "Operation")
                        .HasDatabaseName("IX_ColumnSecurityRules_Table_Column_Operation");

                    b.ToTable("ColumnSecurityRules", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ComplianceControl", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid?>("AssessedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("assessed_by");

                    b.Property<string>("Category")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)")
                        .HasColumnName("category");

                    b.Property<string>("ControlDescription")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("control_description");

                    b.Property<string>("ControlId")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("control_id");

                    b.Property<string>("ControlName")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("control_name");

                    b.Property<string>("Evidence")
                        .HasColumnType("text")
                        .HasColumnName("evidence");

                    b.Property<string>("Gaps")
                        .HasColumnType("text")
                        .HasColumnName("gaps");

                    b.Property<string>("Implementation")
                        .HasColumnType("text")
                        .HasColumnName("implementation");

                    b.Property<DateTime?>("LastAssessed")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_assessed");

                    b.Property<Guid>("ReportId")
                        .HasColumnType("uuid")
                        .HasColumnName("report_id");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.HasKey("Id");

                    b.HasIndex("AssessedBy");

                    b.HasIndex("ControlId")
                        .HasDatabaseName("idx_compliance_controls_control_id");

                    b.HasIndex("ReportId")
                        .HasDatabaseName("idx_compliance_controls_report_id");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_compliance_controls_status");

                    b.ToTable("compliance_controls", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ComplianceReport", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<double>("ComplianceScore")
                        .HasColumnType("double precision")
                        .HasColumnName("compliance_score");

                    b.Property<string>("Format")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("format");

                    b.Property<string>("Framework")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("framework");

                    b.Property<DateTime>("GeneratedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("generated_at");

                    b.Property<Guid>("GeneratedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("generated_by");

                    b.Property<int>("ImplementedControls")
                        .HasColumnType("integer")
                        .HasColumnName("implemented_controls");

                    b.Property<int>("NotImplementedControls")
                        .HasColumnType("integer")
                        .HasColumnName("not_implemented_controls");

                    b.Property<int>("PartialControls")
                        .HasColumnType("integer")
                        .HasColumnName("partial_controls");

                    b.Property<DateTime>("PeriodEnd")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("period_end");

                    b.Property<DateTime>("PeriodStart")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("period_start");

                    b.Property<string>("Recommendations")
                        .HasColumnType("text")
                        .HasColumnName("recommendations");

                    b.Property<string>("ReportPath")
                        .IsRequired()
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("report_path");

                    b.Property<string>("ReportType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("report_type");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<string>("Summary")
                        .HasColumnType("text")
                        .HasColumnName("summary");

                    b.Property<int>("TotalControls")
                        .HasColumnType("integer")
                        .HasColumnName("total_controls");

                    b.HasKey("Id");

                    b.HasIndex("Framework")
                        .HasDatabaseName("idx_compliance_reports_framework");

                    b.HasIndex("GeneratedAt")
                        .HasDatabaseName("idx_compliance_reports_generated_at");

                    b.HasIndex("GeneratedBy");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_compliance_reports_status");

                    b.ToTable("compliance_reports", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ContextPolicy", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("Action")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasDefaultValue("*");

                    b.Property<string[]>("AllowedCountries")
                        .HasColumnType("text[]");

                    b.Property<string>("AllowedDaysOfWeek")
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)");

                    b.Property<string[]>("AllowedDeviceTypes")
                        .HasColumnType("text[]");

                    b.Property<TimeSpan?>("AllowedEndTime")
                        .HasColumnType("interval");

                    b.Property<string[]>("AllowedNetworkZones")
                        .HasColumnType("text[]");

                    b.Property<TimeSpan?>("AllowedStartTime")
                        .HasColumnType("interval");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid");

                    b.Property<string[]>("DeniedCountries")
                        .HasColumnType("text[]");

                    b.Property<bool>("DenyImpossibleTravel")
                        .HasColumnType("boolean");

                    b.Property<bool>("EnableDeviceRestriction")
                        .HasColumnType("boolean");

                    b.Property<bool>("EnableLocationRestriction")
                        .HasColumnType("boolean");

                    b.Property<bool>("EnableRiskRestriction")
                        .HasColumnType("boolean");

                    b.Property<bool>("EnableTimeRestriction")
                        .HasColumnType("boolean");

                    b.Property<int?>("HighRiskThreshold")
                        .HasColumnType("integer");

                    b.Property<bool>("IsActive")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true);

                    b.Property<int?>("MaxAllowedRiskScore")
                        .HasColumnType("integer");

                    b.Property<bool>("RequireApprovalOnHighRisk")
                        .HasColumnType("boolean");

                    b.Property<bool>("RequireCompliantDevice")
                        .HasColumnType("boolean");

                    b.Property<bool>("RequireMfaOnHighRisk")
                        .HasColumnType("boolean");

                    b.Property<string>("ResourceType")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id");

                    b.HasIndex("ResourceType", "Action", "IsActive")
                        .HasDatabaseName("IX_ContextPolicies_Resource_Action_Active");

                    b.ToTable("ContextPolicies", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.DatabaseConfig", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("AdditionalConfig")
                        .HasColumnType("jsonb")
                        .HasColumnName("additional_config");

                    b.Property<DateTime>("ConfiguredAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("ConfiguredBy")
                        .HasColumnType("uuid");

                    b.Property<string>("EncryptedConnectionUrl")
                        .IsRequired()
                        .HasMaxLength(2000)
                        .HasColumnType("character varying(2000)");

                    b.Property<string>("EncryptedPassword")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)");

                    b.Property<string>("EncryptedUsername")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)");

                    b.Property<bool>("IsDeleted")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false);

                    b.Property<DateTime?>("LastRotatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<int>("MaxConnectionLifetimeSeconds")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(3600);

                    b.Property<int>("MaxIdleConnections")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(2);

                    b.Property<int>("MaxOpenConnections")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(4);

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)");

                    b.Property<string>("Plugin")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)");

                    b.HasKey("Id");

                    b.HasIndex("ConfiguredAt");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasFilter("is_deleted = false");

                    b.HasIndex("Plugin");

                    b.ToTable("database_configs", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.DatabaseLease", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid");

                    b.Property<Guid>("DatabaseConfigId")
                        .HasColumnType("uuid");

                    b.Property<Guid>("DatabaseRoleId")
                        .HasColumnType("uuid");

                    b.Property<string>("EncryptedPassword")
                        .IsRequired()
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("GeneratedUsername")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)");

                    b.Property<bool>("IsRevoked")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false);

                    b.Property<string>("LeaseId")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)");

                    b.Property<int>("RenewalCount")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0);

                    b.Property<DateTime?>("RevokedAt")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("DatabaseRoleId");

                    b.HasIndex("ExpiresAt");

                    b.HasIndex("IsRevoked");

                    b.HasIndex("LeaseId")
                        .IsUnique();

                    b.HasIndex("DatabaseConfigId", "IsRevoked");

                    b.ToTable("database_leases", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.DatabaseRole", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid");

                    b.Property<string>("CreationStatements")
                        .IsRequired()
                        .HasMaxLength(10000)
                        .HasColumnType("character varying(10000)");

                    b.Property<Guid>("DatabaseConfigId")
                        .HasColumnType("uuid");

                    b.Property<int>("DefaultTtlSeconds")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(3600);

                    b.Property<bool>("IsDeleted")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false);

                    b.Property<int>("MaxTtlSeconds")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(86400);

                    b.Property<string>("RenewStatements")
                        .HasMaxLength(10000)
                        .HasColumnType("character varying(10000)");

                    b.Property<string>("RevocationStatements")
                        .HasMaxLength(10000)
                        .HasColumnType("character varying(10000)");

                    b.Property<string>("RoleName")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)");

                    b.Property<string>("RollbackStatements")
                        .HasMaxLength(10000)
                        .HasColumnType("character varying(10000)");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("DatabaseConfigId", "RoleName")
                        .IsUnique()
                        .HasFilter("is_deleted = false");

                    b.ToTable("database_roles", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.FlowApproval", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<DateTime?>("ApprovedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("ApproverId")
                        .HasColumnType("uuid");

                    b.Property<string>("Comment")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("FlowInstanceId")
                        .HasColumnType("uuid");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasColumnType("text");

                    b.HasKey("Id");

                    b.HasIndex("ApproverId");

                    b.HasIndex("FlowInstanceId");

                    b.ToTable("FlowApprovals");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.JitAccess", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("AccessLevel")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("access_level");

                    b.Property<Guid?>("ApprovalId")
                        .HasColumnType("uuid")
                        .HasColumnName("approval_id");

                    b.Property<bool>("AutoDeprovisioningCompleted")
                        .HasColumnType("boolean")
                        .HasColumnName("auto_deprovisioning_completed");

                    b.Property<bool>("AutoProvisioningCompleted")
                        .HasColumnType("boolean")
                        .HasColumnName("auto_provisioning_completed");

                    b.Property<string>("DeprovisioningDetails")
                        .HasColumnType("text")
                        .HasColumnName("deprovisioning_details");

                    b.Property<int>("DurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("duration_minutes");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<DateTime?>("GrantedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("granted_at");

                    b.Property<string>("IpAddress")
                        .HasColumnType("text")
                        .HasColumnName("ip_address");

                    b.Property<string>("Justification")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("justification");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("ProvisioningDetails")
                        .HasColumnType("text")
                        .HasColumnName("provisioning_details");

                    b.Property<DateTime>("RequestedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("requested_at");

                    b.Property<Guid>("ResourceId")
                        .HasColumnType("uuid")
                        .HasColumnName("resource_id");

                    b.Property<string>("ResourceName")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("resource_name");

                    b.Property<string>("ResourceType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("resource_type");

                    b.Property<string>("RevocationReason")
                        .HasColumnType("text")
                        .HasColumnName("revocation_reason");

                    b.Property<DateTime?>("RevokedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("revoked_at");

                    b.Property<Guid?>("RevokedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("revoked_by");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<Guid?>("TemplateId")
                        .HasColumnType("uuid")
                        .HasColumnName("template_id");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text")
                        .HasColumnName("user_agent");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.HasKey("Id");

                    b.HasIndex("ApprovalId");

                    b.HasIndex("ExpiresAt")
                        .HasDatabaseName("idx_jit_accesses_expires_at");

                    b.HasIndex("RequestedAt")
                        .HasDatabaseName("idx_jit_accesses_requested_at");

                    b.HasIndex("ResourceId")
                        .HasDatabaseName("idx_jit_accesses_resource_id");

                    b.HasIndex("ResourceType")
                        .HasDatabaseName("idx_jit_accesses_resource_type");

                    b.HasIndex("RevokedBy");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_jit_accesses_status");

                    b.HasIndex("TemplateId");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_jit_accesses_user_id");

                    b.ToTable("jit_accesses", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.JitAccessTemplate", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("AccessLevel")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("access_level");

                    b.Property<bool>("Active")
                        .HasColumnType("boolean")
                        .HasColumnName("active");

                    b.Property<string>("AllowedRoles")
                        .HasColumnType("jsonb")
                        .HasColumnName("allowed_roles");

                    b.Property<string>("ApprovalPolicy")
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("approval_policy");

                    b.Property<string>("Approvers")
                        .HasColumnType("jsonb")
                        .HasColumnName("approvers");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<int>("DefaultDurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("default_duration_minutes");

                    b.Property<string>("Description")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<DateTime?>("LastUsed")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_used");

                    b.Property<int>("MaxDurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("max_duration_minutes");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<int>("MinDurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("min_duration_minutes");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<bool>("RequiresApproval")
                        .HasColumnType("boolean")
                        .HasColumnName("requires_approval");

                    b.Property<bool>("RequiresJustification")
                        .HasColumnType("boolean")
                        .HasColumnName("requires_justification");

                    b.Property<Guid?>("ResourceId")
                        .HasColumnType("uuid")
                        .HasColumnName("resource_id");

                    b.Property<string>("ResourceType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("resource_type");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<int>("UsageCount")
                        .HasColumnType("integer")
                        .HasColumnName("usage_count");

                    b.HasKey("Id");

                    b.HasIndex("Active")
                        .HasDatabaseName("idx_jit_access_templates_active");

                    b.HasIndex("Name")
                        .HasDatabaseName("idx_jit_access_templates_name");

                    b.HasIndex("ResourceType")
                        .HasDatabaseName("idx_jit_access_templates_resource_type");

                    b.ToTable("jit_access_templates", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.LdapConfiguration", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("BaseDn")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("base_dn");

                    b.Property<string>("BindDn")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("bind_dn");

                    b.Property<string>("BindPassword")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("bind_password");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<Guid?>("DefaultRoleId")
                        .HasColumnType("uuid")
                        .HasColumnName("default_role_id");

                    b.Property<string>("EmailAttribute")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("email_attribute");

                    b.Property<bool>("EnableGroupSync")
                        .HasColumnType("boolean")
                        .HasColumnName("enable_group_sync");

                    b.Property<bool>("EnableJitProvisioning")
                        .HasColumnType("boolean")
                        .HasColumnName("enable_jit_provisioning");

                    b.Property<string>("FirstNameAttribute")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("first_name_attribute");

                    b.Property<string>("GroupMembershipAttribute")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("group_membership_attribute");

                    b.Property<string>("GroupRoleMapping")
                        .HasColumnType("jsonb")
                        .HasColumnName("group_role_mapping");

                    b.Property<string>("GroupSearchBase")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("group_search_base");

                    b.Property<string>("GroupSearchFilter")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("group_search_filter");

                    b.Property<int>("GroupSyncIntervalMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("group_sync_interval_minutes");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean")
                        .HasColumnName("is_active");

                    b.Property<DateTime?>("LastGroupSync")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_group_sync");

                    b.Property<string>("LastNameAttribute")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("last_name_attribute");

                    b.Property<string>("LastTestResult")
                        .HasColumnType("text")
                        .HasColumnName("last_test_result");

                    b.Property<DateTime?>("LastTestedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_tested_at");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(200)
                        .HasColumnType("character varying(200)")
                        .HasColumnName("name");

                    b.Property<bool>("NestedGroupsEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("nested_groups_enabled");

                    b.Property<int>("Port")
                        .HasColumnType("integer")
                        .HasColumnName("port");

                    b.Property<string>("ServerUrl")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("server_url");

                    b.Property<bool>("SyncGroupsAsRoles")
                        .HasColumnType("boolean")
                        .HasColumnName("sync_groups_as_roles");

                    b.Property<bool>("UpdateUserOnLogin")
                        .HasColumnType("boolean")
                        .HasColumnName("update_user_on_login");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<bool>("UseSsl")
                        .HasColumnType("boolean")
                        .HasColumnName("use_ssl");

                    b.Property<bool>("UseTls")
                        .HasColumnType("boolean")
                        .HasColumnName("use_tls");

                    b.Property<string>("UserSearchBase")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("user_search_base");

                    b.Property<string>("UserSearchFilter")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("user_search_filter");

                    b.Property<string>("UsernameAttribute")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("username_attribute");

                    b.HasKey("Id");

                    b.HasIndex("CreatedBy");

                    b.HasIndex("IsActive")
                        .HasDatabaseName("idx_ldap_configs_is_active");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("idx_ldap_configs_name");

                    b.ToTable("ldap_configurations", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.MagicLink", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Email")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("IpAddress")
                        .HasColumnType("text");

                    b.Property<bool>("IsUsed")
                        .HasColumnType("boolean");

                    b.Property<string>("RedirectUrl")
                        .HasColumnType("text");

                    b.Property<string>("Token")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime?>("UsedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("MagicLinks");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.MfaBackupCode", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("CodeHash")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<bool>("IsUsed")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("UsedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("MfaBackupCodes");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.MfaDevice", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("DeviceFingerprint")
                        .HasColumnType("text");

                    b.Property<string>("DeviceName")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("DevicePlatform")
                        .HasColumnType("text");

                    b.Property<string>("DeviceType")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("Email")
                        .HasColumnType("text");

                    b.Property<DateTime>("EnrolledAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<bool>("IsPrimary")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("LastUsedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("PhoneNumber")
                        .HasColumnType("text");

                    b.Property<string>("PushToken")
                        .HasColumnType("text");

                    b.Property<DateTime>("RegisteredAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("MfaDevices");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.OAuth2AuthorizationCode", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<Guid>("ClientId")
                        .HasColumnType("uuid");

                    b.Property<string>("Code")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("CodeChallenge")
                        .HasColumnType("text");

                    b.Property<string>("CodeChallengeMethod")
                        .HasColumnType("text");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<bool>("IsUsed")
                        .HasColumnType("boolean");

                    b.Property<string>("RedirectUri")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("Scope")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("ClientId");

                    b.HasIndex("UserId");

                    b.ToTable("OAuth2AuthorizationCodes");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.OAuth2Client", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<List<string>>("AllowedGrantTypes")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<List<string>>("AllowedScopes")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<string>("ClientId")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("ClientName")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("ClientSecret")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("ClientType")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<List<string>>("RedirectUris")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<bool>("RequirePkce")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.HasKey("Id");

                    b.ToTable("OAuth2Clients");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Permission", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Action")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("action");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("Resource")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("resource");

                    b.HasKey("Id");

                    b.HasIndex("Action")
                        .HasDatabaseName("idx_permissions_action");

                    b.HasIndex("Resource")
                        .HasDatabaseName("idx_permissions_resource");

                    b.HasIndex("Resource", "Action")
                        .IsUnique()
                        .HasDatabaseName("unique_permission");

                    b.ToTable("permissions", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PkiCertificateAuthority", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("CertificatePem")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("certificate_pem");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<string>("EncryptedPrivateKey")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("encrypted_private_key");

                    b.Property<long>("IssuedCertificateCount")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("bigint")
                        .HasDefaultValue(0L)
                        .HasColumnName("issued_certificate_count");

                    b.Property<string>("KeyType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("key_type");

                    b.Property<int>("MaxPathLength")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(0)
                        .HasColumnName("max_path_length");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<DateTime>("NotAfter")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("not_after");

                    b.Property<DateTime>("NotBefore")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("not_before");

                    b.Property<Guid?>("ParentCaId")
                        .HasColumnType("uuid")
                        .HasColumnName("parent_ca_id");

                    b.Property<bool>("Revoked")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("revoked");

                    b.Property<DateTime?>("RevokedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("revoked_at");

                    b.Property<string>("SerialNumber")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("serial_number");

                    b.Property<string>("SubjectDn")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("subject_dn");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("type");

                    b.HasKey("Id");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("idx_pki_cas_name");

                    b.HasIndex("ParentCaId")
                        .HasDatabaseName("idx_pki_cas_parent_ca_id");

                    b.ToTable("pki_certificate_authorities", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PkiIssuedCertificate", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("CertificateAuthorityId")
                        .HasColumnType("uuid")
                        .HasColumnName("certificate_authority_id");

                    b.Property<string>("CertificatePem")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("certificate_pem");

                    b.Property<DateTime>("IssuedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("issued_at");

                    b.Property<Guid>("IssuedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("issued_by");

                    b.Property<DateTime>("NotAfter")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("not_after");

                    b.Property<DateTime>("NotBefore")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("not_before");

                    b.Property<bool>("Revoked")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("revoked");

                    b.Property<DateTime?>("RevokedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("revoked_at");

                    b.Property<Guid?>("RoleId")
                        .HasColumnType("uuid")
                        .HasColumnName("role_id");

                    b.Property<string>("SerialNumber")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("serial_number");

                    b.Property<string>("SubjectDn")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("subject_dn");

                    b.HasKey("Id");

                    b.HasIndex("CertificateAuthorityId")
                        .HasDatabaseName("idx_pki_issued_certs_ca_id");

                    b.HasIndex("Revoked")
                        .HasDatabaseName("idx_pki_issued_certs_revoked");

                    b.HasIndex("RoleId")
                        .HasDatabaseName("idx_pki_issued_certs_role_id");

                    b.HasIndex("SerialNumber")
                        .IsUnique()
                        .HasDatabaseName("idx_pki_issued_certs_serial");

                    b.ToTable("pki_issued_certificates", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PkiRole", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<bool>("AllowBareDomains")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("allow_bare_domains");

                    b.Property<bool>("AllowIpSans")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("allow_ip_sans");

                    b.Property<bool>("AllowLocalhost")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("allow_localhost");

                    b.Property<bool>("AllowSubdomains")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("allow_subdomains");

                    b.Property<bool>("AllowWildcards")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("allow_wildcards");

                    b.Property<string>("AllowedDomains")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasColumnType("text")
                        .HasDefaultValue("[]")
                        .HasColumnName("allowed_domains");

                    b.Property<Guid>("CertificateAuthorityId")
                        .HasColumnType("uuid")
                        .HasColumnName("certificate_authority_id");

                    b.Property<bool>("ClientAuth")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("client_auth");

                    b.Property<bool>("CodeSigning")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("code_signing");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<bool>("EmailProtection")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(false)
                        .HasColumnName("email_protection");

                    b.Property<string>("KeyType")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasDefaultValue("rsa-2048")
                        .HasColumnName("key_type");

                    b.Property<int>("MaxTtlDays")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(3650)
                        .HasColumnName("max_ttl_days");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<bool>("ServerAuth")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("boolean")
                        .HasDefaultValue(true)
                        .HasColumnName("server_auth");

                    b.Property<int>("TtlDays")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("integer")
                        .HasDefaultValue(365)
                        .HasColumnName("ttl_days");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.HasIndex("CertificateAuthorityId")
                        .HasDatabaseName("idx_pki_roles_ca_id");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("idx_pki_roles_name");

                    b.ToTable("pki_roles", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedAccount", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("AccountName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("account_name");

                    b.Property<string>("ConnectionDetails")
                        .HasColumnType("jsonb")
                        .HasColumnName("connection_details");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("DatabaseName")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("database_name");

                    b.Property<string>("EncryptedPassword")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("encrypted_password");

                    b.Property<string>("HostAddress")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("host_address");

                    b.Property<DateTime?>("LastRotated")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_rotated");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<DateTime?>("NextRotation")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("next_rotation");

                    b.Property<int?>("PasswordComplexity")
                        .HasColumnType("integer")
                        .HasColumnName("password_complexity");

                    b.Property<string>("Platform")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("platform");

                    b.Property<int?>("Port")
                        .HasColumnType("integer")
                        .HasColumnName("port");

                    b.Property<bool>("RequireMfa")
                        .HasColumnType("boolean")
                        .HasColumnName("require_mfa");

                    b.Property<bool>("RequiresDualApproval")
                        .HasColumnType("boolean");

                    b.Property<bool>("RequiresMfa")
                        .HasColumnType("boolean");

                    b.Property<bool>("RotationEnabled")
                        .HasColumnType("boolean");

                    b.Property<int>("RotationIntervalDays")
                        .HasColumnType("integer")
                        .HasColumnName("rotation_interval_days");

                    b.Property<string>("RotationPolicy")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("rotation_policy");

                    b.Property<Guid>("SafeId")
                        .HasColumnType("uuid")
                        .HasColumnName("safe_id");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<string>("Username")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("username");

                    b.HasKey("Id");

                    b.HasIndex("NextRotation")
                        .HasDatabaseName("idx_privileged_accounts_next_rotation");

                    b.HasIndex("Platform")
                        .HasDatabaseName("idx_privileged_accounts_platform");

                    b.HasIndex("SafeId")
                        .HasDatabaseName("idx_privileged_accounts_safe_id");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_privileged_accounts_status");

                    b.ToTable("privileged_accounts", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedSafe", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("AccessControl")
                        .IsRequired()
                        .HasColumnType("jsonb")
                        .HasColumnName("access_control");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<int>("MaxCheckoutDurationMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("max_checkout_duration_minutes");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<Guid>("OwnerId")
                        .HasColumnType("uuid")
                        .HasColumnName("owner_id");

                    b.Property<bool>("RequireApproval")
                        .HasColumnType("boolean")
                        .HasColumnName("require_approval");

                    b.Property<bool>("RequireDualControl")
                        .HasColumnType("boolean")
                        .HasColumnName("require_dual_control");

                    b.Property<bool>("RotateOnCheckin")
                        .HasColumnType("boolean")
                        .HasColumnName("rotate_on_checkin");

                    b.Property<string>("SafeType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("safe_type");

                    b.Property<bool>("SessionRecordingEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("session_recording_enabled");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.HasIndex("OwnerId")
                        .HasDatabaseName("idx_privileged_safes_owner_id");

                    b.HasIndex("SafeType")
                        .HasDatabaseName("idx_privileged_safes_safe_type");

                    b.ToTable("privileged_safes", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedSession", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<Guid>("AccountCheckoutId")
                        .HasColumnType("uuid")
                        .HasColumnName("account_checkout_id");

                    b.Property<Guid>("AccountId")
                        .HasColumnType("uuid")
                        .HasColumnName("account_id");

                    b.Property<int>("CommandCount")
                        .HasColumnType("integer")
                        .HasColumnName("command_count");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<int?>("Duration")
                        .HasColumnType("integer");

                    b.Property<DateTime?>("EndTime")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("end_time");

                    b.Property<int?>("FrameRate")
                        .HasColumnType("integer");

                    b.Property<string>("HostAddress")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("host_address");

                    b.Property<string>("IpAddress")
                        .HasColumnType("text")
                        .HasColumnName("ip_address");

                    b.Property<bool>("IsRecorded")
                        .HasColumnType("boolean");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Platform")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("platform");

                    b.Property<int?>("Port")
                        .HasColumnType("integer")
                        .HasColumnName("port");

                    b.Property<string>("Protocol")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("protocol");

                    b.Property<int>("QueryCount")
                        .HasColumnType("integer")
                        .HasColumnName("query_count");

                    b.Property<string>("RecordingFormat")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("RecordingPath")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("recording_path");

                    b.Property<long>("RecordingSize")
                        .HasColumnType("bigint")
                        .HasColumnName("recording_size");

                    b.Property<string>("SessionType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("session_type");

                    b.Property<DateTime>("StartTime")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("start_time");

                    b.Property<DateTime>("StartedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<string>("SuspiciousActivityDetails")
                        .HasColumnType("text")
                        .HasColumnName("suspicious_activity_details");

                    b.Property<bool>("SuspiciousActivityDetected")
                        .HasColumnType("boolean")
                        .HasColumnName("suspicious_activity_detected");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text")
                        .HasColumnName("user_agent");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.Property<string>("VideoCodec")
                        .HasColumnType("text");

                    b.HasKey("Id");

                    b.HasIndex("AccountCheckoutId")
                        .HasDatabaseName("idx_privileged_sessions_checkout_id");

                    b.HasIndex("AccountId")
                        .HasDatabaseName("idx_privileged_sessions_account_id");

                    b.HasIndex("StartTime")
                        .HasDatabaseName("idx_privileged_sessions_start_time");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_privileged_sessions_status");

                    b.HasIndex("SuspiciousActivityDetected")
                        .HasDatabaseName("idx_privileged_sessions_suspicious");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_privileged_sessions_user_id");

                    b.ToTable("privileged_sessions", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.RiskAssessment", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("Action")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("AssessedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("DeviceFingerprint")
                        .HasColumnType("text");

                    b.Property<string>("IpAddress")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<List<string>>("RiskFactors")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<string>("RiskLevel")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<int>("RiskScore")
                        .HasColumnType("integer");

                    b.Property<string>("UserAgent")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("RiskAssessments");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Role", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<bool>("IsBuiltIn")
                        .HasColumnType("boolean")
                        .HasColumnName("is_system_role");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.ToTable("roles", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.RolePermission", b =>
                {
                    b.Property<Guid>("RoleId")
                        .HasColumnType("uuid")
                        .HasColumnName("role_id");

                    b.Property<Guid>("PermissionId")
                        .HasColumnType("uuid")
                        .HasColumnName("permission_id");

                    b.Property<DateTime>("AssignedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime>("GrantedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("granted_at");

                    b.HasKey("RoleId", "PermissionId");

                    b.HasIndex("PermissionId");

                    b.ToTable("role_permissions", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.SamlIdentityProvider", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<Guid?>("DefaultRoleId")
                        .HasColumnType("uuid")
                        .HasColumnName("default_role_id");

                    b.Property<string>("EmailAttributeName")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("email_attribute_name");

                    b.Property<bool>("EnableJitProvisioning")
                        .HasColumnType("boolean")
                        .HasColumnName("enable_jit_provisioning");

                    b.Property<string>("EntityId")
                        .IsRequired()
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("entity_id");

                    b.Property<string>("FirstNameAttributeName")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("first_name_attribute_name");

                    b.Property<string>("GroupsAttributeName")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("groups_attribute_name");

                    b.Property<bool>("IsEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("is_enabled");

                    b.Property<string>("LastNameAttributeName")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("last_name_attribute_name");

                    b.Property<string>("MetadataXml")
                        .HasColumnType("text")
                        .HasColumnName("metadata_xml");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<bool>("RequireSignedAssertions")
                        .HasColumnType("boolean")
                        .HasColumnName("require_signed_assertions");

                    b.Property<string>("RoleMapping")
                        .HasColumnType("jsonb")
                        .HasColumnName("role_mapping");

                    b.Property<bool>("SignAuthnRequests")
                        .HasColumnType("boolean")
                        .HasColumnName("sign_authn_requests");

                    b.Property<string>("SigningCertificate")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("signing_certificate");

                    b.Property<string>("SloServiceUrl")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("slo_service_url");

                    b.Property<string>("SsoServiceUrl")
                        .IsRequired()
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("sso_service_url");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.HasIndex("CreatedBy");

                    b.HasIndex("DefaultRoleId");

                    b.HasIndex("EntityId")
                        .IsUnique()
                        .HasDatabaseName("idx_saml_idps_entity_id");

                    b.HasIndex("IsEnabled")
                        .HasDatabaseName("idx_saml_idps_is_enabled");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("idx_saml_idps_name");

                    b.ToTable("saml_identity_providers", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.SealConfiguration", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("EncryptedMasterKey")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<bool>("Initialized")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("LastUnsealedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<int>("SecretShares")
                        .HasColumnType("integer");

                    b.Property<int>("SecretThreshold")
                        .HasColumnType("integer");

                    b.Property<int>("Version")
                        .HasColumnType("integer");

                    b.HasKey("Id");

                    b.ToTable("SealConfigurations");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Secret", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid?>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("deleted_at");

                    b.Property<string>("EncryptedData")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<byte[]>("EncryptedValue")
                        .IsRequired()
                        .HasColumnType("bytea")
                        .HasColumnName("encrypted_value");

                    b.Property<int>("EncryptionKeyVersion")
                        .HasColumnType("integer")
                        .HasColumnName("encryption_key_version");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("boolean");

                    b.Property<bool>("IsDestroyed")
                        .HasColumnType("boolean");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<string>("Path")
                        .IsRequired()
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("path");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<int>("Version")
                        .HasColumnType("integer")
                        .HasColumnName("version");

                    b.HasKey("Id");

                    b.HasIndex("CreatedBy")
                        .HasDatabaseName("idx_secrets_created_by");

                    b.HasIndex("Path")
                        .IsUnique()
                        .HasDatabaseName("idx_secrets_path");

                    b.ToTable("secrets", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.SecretAccessLog", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("AccessType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("access_type");

                    b.Property<DateTime>("AccessedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("accessed_at");

                    b.Property<Guid?>("AccessedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("accessed_by");

                    b.Property<IPAddress>("IpAddress")
                        .HasColumnType("inet")
                        .HasColumnName("ip_address");

                    b.Property<Guid?>("SecretId")
                        .HasColumnType("uuid")
                        .HasColumnName("secret_id");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text")
                        .HasColumnName("user_agent");

                    b.HasKey("Id");

                    b.HasIndex("AccessedAt")
                        .HasDatabaseName("idx_secret_access_log_accessed_at");

                    b.HasIndex("AccessedBy");

                    b.HasIndex("SecretId")
                        .HasDatabaseName("idx_secret_access_log_secret_id");

                    b.ToTable("secret_access_log", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Session", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<IPAddress>("IpAddress")
                        .HasColumnType("inet")
                        .HasColumnName("ip_address");

                    b.Property<DateTime>("LastActivity")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_activity");

                    b.Property<string>("RefreshTokenHash")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("refresh_token_hash");

                    b.Property<bool>("Revoked")
                        .HasColumnType("boolean")
                        .HasColumnName("revoked");

                    b.Property<DateTime?>("RevokedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("revoked_at");

                    b.Property<string>("TokenHash")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("token_hash");

                    b.Property<string>("UserAgent")
                        .HasColumnType("text")
                        .HasColumnName("user_agent");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.HasKey("Id");

                    b.HasIndex("ExpiresAt")
                        .HasDatabaseName("idx_sessions_expires_at");

                    b.HasIndex("Revoked")
                        .HasDatabaseName("idx_sessions_revoked");

                    b.HasIndex("TokenHash")
                        .IsUnique()
                        .HasDatabaseName("idx_sessions_token_hash");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_sessions_user_id");

                    b.ToTable("sessions", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.SessionCommand", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<string>("Command")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("command");

                    b.Property<string>("CommandType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("command_type");

                    b.Property<string>("ErrorMessage")
                        .HasColumnType("text")
                        .HasColumnName("error_message");

                    b.Property<DateTime>("ExecutedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("executed_at");

                    b.Property<int>("ExecutionTimeMs")
                        .HasColumnType("integer")
                        .HasColumnName("execution_time_ms");

                    b.Property<bool>("IsSuspicious")
                        .HasColumnType("boolean")
                        .HasColumnName("is_suspicious");

                    b.Property<string>("Response")
                        .HasColumnType("text")
                        .HasColumnName("response");

                    b.Property<int>("ResponseSize")
                        .HasColumnType("integer")
                        .HasColumnName("response_size");

                    b.Property<int>("SequenceNumber")
                        .HasColumnType("integer")
                        .HasColumnName("sequence_number");

                    b.Property<Guid>("SessionId")
                        .HasColumnType("uuid")
                        .HasColumnName("session_id");

                    b.Property<bool>("Success")
                        .HasColumnType("boolean")
                        .HasColumnName("success");

                    b.Property<string>("SuspiciousReason")
                        .HasColumnType("text")
                        .HasColumnName("suspicious_reason");

                    b.HasKey("Id");

                    b.HasIndex("ExecutedAt")
                        .HasDatabaseName("idx_session_commands_executed_at");

                    b.HasIndex("IsSuspicious")
                        .HasDatabaseName("idx_session_commands_suspicious");

                    b.HasIndex("SequenceNumber")
                        .HasDatabaseName("idx_session_commands_sequence");

                    b.HasIndex("SessionId")
                        .HasDatabaseName("idx_session_commands_session_id");

                    b.ToTable("session_commands", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.TransitKey", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<bool>("AllowPlaintextBackup")
                        .HasColumnType("boolean")
                        .HasColumnName("allow_plaintext_backup");

                    b.Property<bool>("ConvergentEncryption")
                        .HasColumnType("boolean")
                        .HasColumnName("convergent_encryption");

                    b.Property<int?>("ConvergentVersion")
                        .HasColumnType("integer")
                        .HasColumnName("convergent_version");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<long>("DecryptionCount")
                        .HasColumnType("bigint")
                        .HasColumnName("decryption_count");

                    b.Property<bool>("DeletionAllowed")
                        .HasColumnType("boolean")
                        .HasColumnName("deletion_allowed");

                    b.Property<bool>("Derived")
                        .HasColumnType("boolean")
                        .HasColumnName("derived");

                    b.Property<long>("EncryptionCount")
                        .HasColumnType("bigint")
                        .HasColumnName("encryption_count");

                    b.Property<bool>("Exportable")
                        .HasColumnType("boolean")
                        .HasColumnName("exportable");

                    b.Property<bool>("IsDeleted")
                        .HasColumnType("boolean");

                    b.Property<int>("LatestVersion")
                        .HasColumnType("integer")
                        .HasColumnName("latest_version");

                    b.Property<int>("MinDecryptionVersion")
                        .HasColumnType("integer")
                        .HasColumnName("min_decryption_version");

                    b.Property<int>("MinEncryptionVersion")
                        .HasColumnType("integer")
                        .HasColumnName("min_encryption_version");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<long>("SigningCount")
                        .HasColumnType("bigint")
                        .HasColumnName("signing_count");

                    b.Property<string>("Type")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("type");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<long>("VerificationCount")
                        .HasColumnType("bigint")
                        .HasColumnName("verification_count");

                    b.HasKey("Id");

                    b.HasIndex("CreatedBy")
                        .HasDatabaseName("idx_transit_keys_created_by");

                    b.HasIndex("Name")
                        .IsUnique()
                        .HasDatabaseName("idx_transit_keys_name");

                    b.ToTable("transit_keys", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.TransitKeyVersion", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime?>("ArchivedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("archived_at");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<Guid>("CreatedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("created_by");

                    b.Property<DateTime?>("DestroyedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("destroyed_at");

                    b.Property<string>("EncryptedKeyMaterial")
                        .IsRequired()
                        .HasColumnType("text")
                        .HasColumnName("encrypted_key_material");

                    b.Property<string>("PublicKey")
                        .HasColumnType("text")
                        .HasColumnName("public_key");

                    b.Property<Guid>("TransitKeyId")
                        .HasColumnType("uuid")
                        .HasColumnName("transit_key_id");

                    b.Property<int>("Version")
                        .HasColumnType("integer")
                        .HasColumnName("version");

                    b.HasKey("Id");

                    b.HasIndex("CreatedBy");

                    b.HasIndex("TransitKeyId")
                        .HasDatabaseName("idx_transit_key_versions_transit_key_id");

                    b.HasIndex("TransitKeyId", "Version")
                        .IsUnique()
                        .HasDatabaseName("idx_transit_key_versions_transit_key_id_version");

                    b.ToTable("transit_key_versions", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.TrustedDevice", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("City")
                        .HasColumnType("text");

                    b.Property<string>("Country")
                        .HasColumnType("text");

                    b.Property<string>("CountryCode")
                        .HasColumnType("text");

                    b.Property<string>("DeviceFingerprint")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("DeviceId")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("DeviceName")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("DeviceType")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<DateTime>("ExpiresAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<string>("IpAddress")
                        .HasColumnType("text");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<bool>("IsTrusted")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("LastLocationUpdate")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime?>("LastUsedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<double?>("Latitude")
                        .HasColumnType("double precision");

                    b.Property<string>("Location")
                        .HasColumnType("text");

                    b.Property<double?>("Longitude")
                        .HasColumnType("double precision");

                    b.Property<string>("Region")
                        .HasColumnType("text");

                    b.Property<DateTime>("RegisteredAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("TrustedDevices");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.UserClearance", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime?>("BackgroundCheckCompletedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("background_check_completed_at");

                    b.Property<string>("BackgroundCheckDetails")
                        .HasColumnType("text")
                        .HasColumnName("background_check_details");

                    b.Property<string>("BackgroundCheckProvider")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("background_check_provider");

                    b.Property<string>("ClearanceLevel")
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("clearance_level");

                    b.Property<string>("ClearanceType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("clearance_type");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("DocumentationPath")
                        .HasMaxLength(1000)
                        .HasColumnType("character varying(1000)")
                        .HasColumnName("documentation_path");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<DateTime>("GrantedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("granted_at");

                    b.Property<Guid>("GrantedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("granted_by");

                    b.Property<DateTime?>("LastReviewedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_reviewed_at");

                    b.Property<Guid?>("LastReviewedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("last_reviewed_by");

                    b.Property<string>("ReviewNotes")
                        .HasColumnType("text")
                        .HasColumnName("review_notes");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<string>("TrainingCompleted")
                        .HasColumnType("text")
                        .HasColumnName("training_completed");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.HasKey("Id");

                    b.HasIndex("ClearanceType")
                        .HasDatabaseName("idx_user_clearances_type");

                    b.HasIndex("ExpiresAt")
                        .HasDatabaseName("idx_user_clearances_expires_at");

                    b.HasIndex("GrantedBy");

                    b.HasIndex("LastReviewedBy");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_user_clearances_status");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_user_clearances_user_id");

                    b.HasIndex("UserId", "ClearanceType", "Status")
                        .HasDatabaseName("idx_user_clearances_user_type_status");

                    b.ToTable("user_clearances", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.UserRiskProfile", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<int>("BaselineRiskScore")
                        .HasColumnType("integer");

                    b.Property<int>("ConsecutiveFailedLogins")
                        .HasColumnType("integer");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<int>("CurrentRiskScore")
                        .HasColumnType("integer");

                    b.Property<bool>("IsCompromised")
                        .HasColumnType("boolean");

                    b.Property<List<string>>("KnownCities")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<List<string>>("KnownCountries")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<List<string>>("KnownDeviceFingerprints")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<List<string>>("KnownIpAddresses")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<string>("LastKnownCity")
                        .HasColumnType("text");

                    b.Property<string>("LastKnownCountry")
                        .HasColumnType("text");

                    b.Property<double?>("LastKnownLatitude")
                        .HasColumnType("double precision");

                    b.Property<double?>("LastKnownLongitude")
                        .HasColumnType("double precision");

                    b.Property<DateTime?>("LastLocationUpdate")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime?>("LastLoginAttempt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime?>("LastMfaEnrollment")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime?>("LastPasswordChange")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime?>("LastSuspiciousActivity")
                        .HasColumnType("timestamp with time zone");

                    b.Property<int>("LoginAttemptsLast24Hours")
                        .HasColumnType("integer");

                    b.Property<int>("LoginAttemptsLastHour")
                        .HasColumnType("integer");

                    b.Property<bool>("RequiresMandatoryMfa")
                        .HasColumnType("boolean");

                    b.Property<string>("RiskTier")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<int>("SuspiciousActivityCount")
                        .HasColumnType("integer");

                    b.Property<int>("TrustScore")
                        .HasColumnType("integer");

                    b.Property<List<int>>("TypicalLoginHours")
                        .IsRequired()
                        .HasColumnType("integer[]");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("UserRiskProfiles");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.UserRole", b =>
                {
                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.Property<Guid>("RoleId")
                        .HasColumnType("uuid")
                        .HasColumnName("role_id");

                    b.Property<DateTime>("AssignedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime?>("ExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("expires_at");

                    b.Property<DateTime>("GrantedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("granted_at");

                    b.Property<Guid?>("GrantedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("granted_by");

                    b.Property<Guid?>("NamespaceId")
                        .HasColumnType("uuid");

                    b.HasKey("UserId", "RoleId");

                    b.HasIndex("GrantedBy");

                    b.HasIndex("RoleId")
                        .HasDatabaseName("idx_user_roles_role_id");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_user_roles_user_id");

                    b.ToTable("user_roles", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WebAuthnCredential", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid");

                    b.Property<string>("AaGuid")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<byte[]>("CredentialId")
                        .IsRequired()
                        .HasColumnType("bytea");

                    b.Property<string>("CredentialType")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<string>("DeviceName")
                        .IsRequired()
                        .HasColumnType("text");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("LastUsedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<byte[]>("PublicKey")
                        .IsRequired()
                        .HasColumnType("bytea");

                    b.Property<DateTime>("RegisteredAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<long>("SignatureCounter")
                        .HasColumnType("bigint");

                    b.Property<List<string>>("Transports")
                        .IsRequired()
                        .HasColumnType("text[]");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid");

                    b.HasKey("Id");

                    b.HasIndex("UserId");

                    b.ToTable("WebAuthnCredentials");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Webhook", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<bool>("Active")
                        .HasColumnType("boolean")
                        .HasColumnName("active");

                    b.Property<string>("AuthenticationType")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("authentication_type");

                    b.Property<DateTime?>("CircuitBreakerOpenedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("circuit_breaker_opened_at");

                    b.Property<int>("CircuitBreakerResetMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("circuit_breaker_reset_minutes");

                    b.Property<string>("CircuitBreakerState")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("circuit_breaker_state");

                    b.Property<int>("CircuitBreakerThreshold")
                        .HasColumnType("integer")
                        .HasColumnName("circuit_breaker_threshold");

                    b.Property<int>("ConsecutiveFailures")
                        .HasColumnType("integer")
                        .HasColumnName("consecutive_failures");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("CustomHeaders")
                        .HasColumnType("jsonb")
                        .HasColumnName("custom_headers");

                    b.Property<string>("Description")
                        .HasColumnType("text")
                        .HasColumnName("description");

                    b.Property<List<string>>("Events")
                        .IsRequired()
                        .HasColumnType("jsonb")
                        .HasColumnName("events");

                    b.Property<int>("FailedDeliveries")
                        .HasColumnType("integer")
                        .HasColumnName("failed_deliveries");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean");

                    b.Property<DateTime?>("LastFailureAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_failure_at");

                    b.Property<DateTime?>("LastSuccessAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_success_at");

                    b.Property<DateTime?>("LastTriggeredAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_triggered_at");

                    b.Property<int>("MaxRetries")
                        .HasColumnType("integer")
                        .HasColumnName("max_retries");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("name");

                    b.Property<string>("OAuth2ClientId")
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("oauth2_client_id");

                    b.Property<string>("OAuth2ClientSecret")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("oauth2_client_secret");

                    b.Property<string>("OAuth2TokenUrl")
                        .HasMaxLength(2000)
                        .HasColumnType("character varying(2000)")
                        .HasColumnName("oauth2_token_url");

                    b.Property<string>("PayloadTemplate")
                        .HasColumnType("text")
                        .HasColumnName("payload_template");

                    b.Property<string>("SecretToken")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("secret_token");

                    b.Property<int>("SuccessfulDeliveries")
                        .HasColumnType("integer")
                        .HasColumnName("successful_deliveries");

                    b.Property<int>("TimeoutSeconds")
                        .HasColumnType("integer")
                        .HasColumnName("timeout_seconds");

                    b.Property<int>("TotalDeliveries")
                        .HasColumnType("integer")
                        .HasColumnName("total_deliveries");

                    b.Property<DateTime?>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<string>("Url")
                        .IsRequired()
                        .HasMaxLength(2000)
                        .HasColumnType("character varying(2000)")
                        .HasColumnName("url");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.Property<bool>("VerifySsl")
                        .HasColumnType("boolean")
                        .HasColumnName("verify_ssl");

                    b.HasKey("Id");

                    b.HasIndex("Active")
                        .HasDatabaseName("idx_webhooks_active");

                    b.HasIndex("Events")
                        .HasDatabaseName("idx_webhooks_events");

                    NpgsqlIndexBuilderExtensions.HasMethod(b.HasIndex("Events"), "gin");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_webhooks_user_id");

                    b.ToTable("webhooks", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WebhookDelivery", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<int>("AttemptCount")
                        .HasColumnType("integer")
                        .HasColumnName("attempt_count");

                    b.Property<DateTime>("AttemptedAt")
                        .HasColumnType("timestamp with time zone");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<DateTime?>("DeliveredAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("delivered_at");

                    b.Property<int>("DurationMs")
                        .HasColumnType("integer")
                        .HasColumnName("duration_ms");

                    b.Property<string>("ErrorMessage")
                        .HasColumnType("text")
                        .HasColumnName("error_message");

                    b.Property<string>("EventType")
                        .IsRequired()
                        .HasMaxLength(255)
                        .HasColumnType("character varying(255)")
                        .HasColumnName("event_type");

                    b.Property<string>("HmacSignature")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("hmac_signature");

                    b.Property<DateTime?>("NextRetryAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("next_retry_at");

                    b.Property<string>("Payload")
                        .IsRequired()
                        .HasColumnType("jsonb")
                        .HasColumnName("payload");

                    b.Property<string>("ResponseBody")
                        .HasColumnType("text")
                        .HasColumnName("response_body");

                    b.Property<int>("ResponseStatus")
                        .HasColumnType("integer")
                        .HasColumnName("response_status");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<bool>("Success")
                        .HasColumnType("boolean");

                    b.Property<Guid>("WebhookId")
                        .HasColumnType("uuid")
                        .HasColumnName("webhook_id");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt")
                        .HasDatabaseName("idx_webhook_deliveries_created_at");

                    b.HasIndex("EventType")
                        .HasDatabaseName("idx_webhook_deliveries_event_type");

                    b.HasIndex("NextRetryAt")
                        .HasDatabaseName("idx_webhook_deliveries_next_retry_at");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_webhook_deliveries_status");

                    b.HasIndex("WebhookId")
                        .HasDatabaseName("idx_webhook_deliveries_webhook_id");

                    b.ToTable("webhook_deliveries", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Workspace", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<string>("CustomDomain")
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("custom_domain");

                    b.Property<DateTime?>("DeletedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("deleted_at");

                    b.Property<string>("Description")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("description");

                    b.Property<string>("IpWhitelist")
                        .HasColumnType("jsonb")
                        .HasColumnName("ip_whitelist");

                    b.Property<bool>("IsBillable")
                        .HasColumnType("boolean")
                        .HasColumnName("is_billable");

                    b.Property<string>("Metadata")
                        .HasColumnType("jsonb")
                        .HasColumnName("metadata");

                    b.Property<int>("MinPasswordLength")
                        .HasColumnType("integer")
                        .HasColumnName("min_password_length");

                    b.Property<long>("MonthlyCostCents")
                        .HasColumnType("bigint")
                        .HasColumnName("monthly_cost_cents");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("character varying(100)")
                        .HasColumnName("name");

                    b.Property<Guid>("OwnerId")
                        .HasColumnType("uuid")
                        .HasColumnName("owner_id");

                    b.Property<Guid?>("ParentWorkspaceId")
                        .HasColumnType("uuid")
                        .HasColumnName("parent_workspace_id");

                    b.Property<bool>("RequireMfa")
                        .HasColumnType("boolean")
                        .HasColumnName("require_mfa");

                    b.Property<int>("SessionTimeoutMinutes")
                        .HasColumnType("integer")
                        .HasColumnName("session_timeout_minutes");

                    b.Property<string>("Settings")
                        .HasColumnType("jsonb")
                        .HasColumnName("settings");

                    b.Property<string>("Slug")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("slug");

                    b.Property<string>("Status")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("status");

                    b.Property<string>("SubscriptionTier")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("subscription_tier");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.HasKey("Id");

                    b.HasIndex("CustomDomain")
                        .HasDatabaseName("idx_workspaces_custom_domain");

                    b.HasIndex("DeletedAt")
                        .HasDatabaseName("idx_workspaces_deleted_at");

                    b.HasIndex("OwnerId")
                        .HasDatabaseName("idx_workspaces_owner_id");

                    b.HasIndex("ParentWorkspaceId")
                        .HasDatabaseName("idx_workspaces_parent_id");

                    b.HasIndex("Slug")
                        .IsUnique()
                        .HasDatabaseName("idx_workspaces_slug");

                    b.HasIndex("Status")
                        .HasDatabaseName("idx_workspaces_status");

                    b.ToTable("workspaces", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WorkspaceMember", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime?>("InvitationExpiresAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("invitation_expires_at");

                    b.Property<string>("InvitationStatus")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("invitation_status");

                    b.Property<string>("InvitationToken")
                        .HasMaxLength(500)
                        .HasColumnType("character varying(500)")
                        .HasColumnName("invitation_token");

                    b.Property<Guid?>("InvitedBy")
                        .HasColumnType("uuid")
                        .HasColumnName("invited_by");

                    b.Property<bool>("IsActive")
                        .HasColumnType("boolean")
                        .HasColumnName("is_active");

                    b.Property<DateTime>("JoinedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("joined_at");

                    b.Property<DateTime?>("LastAccessedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("last_accessed_at");

                    b.Property<DateTime?>("LeftAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("left_at");

                    b.Property<string>("Role")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("character varying(50)")
                        .HasColumnName("role");

                    b.Property<Guid>("UserId")
                        .HasColumnType("uuid")
                        .HasColumnName("user_id");

                    b.Property<Guid>("WorkspaceId")
                        .HasColumnType("uuid")
                        .HasColumnName("workspace_id");

                    b.HasKey("Id");

                    b.HasIndex("InvitationToken")
                        .HasDatabaseName("idx_workspace_members_invitation_token");

                    b.HasIndex("InvitedBy");

                    b.HasIndex("IsActive")
                        .HasDatabaseName("idx_workspace_members_is_active");

                    b.HasIndex("UserId")
                        .HasDatabaseName("idx_workspace_members_user_id");

                    b.HasIndex("WorkspaceId")
                        .HasDatabaseName("idx_workspace_members_workspace_id");

                    b.HasIndex("WorkspaceId", "UserId")
                        .IsUnique()
                        .HasDatabaseName("idx_workspace_members_workspace_user");

                    b.ToTable("workspace_members", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WorkspaceQuota", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<bool>("AdvancedComplianceEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("advanced_compliance_enabled");

                    b.Property<int>("AuditRetentionDays")
                        .HasColumnType("integer")
                        .HasColumnName("audit_retention_days");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<bool>("CustomAuthMethodsEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("custom_auth_methods_enabled");

                    b.Property<int>("MaxApiRequestsPerHour")
                        .HasColumnType("integer")
                        .HasColumnName("max_api_requests_per_hour");

                    b.Property<int>("MaxChildWorkspaces")
                        .HasColumnType("integer")
                        .HasColumnName("max_child_workspaces");

                    b.Property<int>("MaxPamSessions")
                        .HasColumnType("integer")
                        .HasColumnName("max_pam_sessions");

                    b.Property<int>("MaxPrivilegedAccounts")
                        .HasColumnType("integer")
                        .HasColumnName("max_privileged_accounts");

                    b.Property<int>("MaxSecrets")
                        .HasColumnType("integer")
                        .HasColumnName("max_secrets");

                    b.Property<long>("MaxStorageMb")
                        .HasColumnType("bigint")
                        .HasColumnName("max_storage_mb");

                    b.Property<int>("MaxUsers")
                        .HasColumnType("integer")
                        .HasColumnName("max_users");

                    b.Property<bool>("SessionRecordingEnabled")
                        .HasColumnType("boolean")
                        .HasColumnName("session_recording_enabled");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<Guid>("WorkspaceId")
                        .HasColumnType("uuid")
                        .HasColumnName("workspace_id");

                    b.HasKey("Id");

                    b.HasIndex("WorkspaceId")
                        .IsUnique()
                        .HasDatabaseName("idx_workspace_quotas_workspace_id");

                    b.ToTable("workspace_quotas", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WorkspaceUsage", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("uuid")
                        .HasColumnName("id");

                    b.Property<DateTime>("ApiRequestsResetAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("api_requests_reset_at");

                    b.Property<int>("ApiRequestsThisHour")
                        .HasColumnType("integer")
                        .HasColumnName("api_requests_this_hour");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("created_at");

                    b.Property<int>("CurrentChildWorkspaces")
                        .HasColumnType("integer")
                        .HasColumnName("current_child_workspaces");

                    b.Property<int>("CurrentPamSessions")
                        .HasColumnType("integer")
                        .HasColumnName("current_pam_sessions");

                    b.Property<int>("CurrentPrivilegedAccounts")
                        .HasColumnType("integer")
                        .HasColumnName("current_privileged_accounts");

                    b.Property<int>("CurrentSecrets")
                        .HasColumnType("integer")
                        .HasColumnName("current_secrets");

                    b.Property<long>("CurrentStorageMb")
                        .HasColumnType("bigint")
                        .HasColumnName("current_storage_mb");

                    b.Property<int>("CurrentUsers")
                        .HasColumnType("integer")
                        .HasColumnName("current_users");

                    b.Property<long>("TotalApiRequests")
                        .HasColumnType("bigint")
                        .HasColumnName("total_api_requests");

                    b.Property<long>("TotalAuditLogs")
                        .HasColumnType("bigint")
                        .HasColumnName("total_audit_logs");

                    b.Property<long>("TotalSessionRecordings")
                        .HasColumnType("bigint")
                        .HasColumnName("total_session_recordings");

                    b.Property<DateTime>("UpdatedAt")
                        .HasColumnType("timestamp with time zone")
                        .HasColumnName("updated_at");

                    b.Property<Guid>("WorkspaceId")
                        .HasColumnType("uuid")
                        .HasColumnName("workspace_id");

                    b.HasKey("Id");

                    b.HasIndex("WorkspaceId")
                        .IsUnique()
                        .HasDatabaseName("idx_workspace_usages_workspace_id");

                    b.ToTable("workspace_usages", (string)null);
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AccessApproval", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Requester")
                        .WithMany()
                        .HasForeignKey("RequesterId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Requester");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AccountCheckout", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.PrivilegedAccount", "Account")
                        .WithMany("Checkouts")
                        .HasForeignKey("AccountId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.AccessApproval", "Approval")
                        .WithMany("Checkouts")
                        .HasForeignKey("ApprovalId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Account");

                    b.Navigation("Approval");

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ApiKey", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany("ApiKeys")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AuditLog", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany("AuditLogs")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AuthorizationFlowInstance", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.AuthorizationFlow", "Flow")
                        .WithMany("FlowInstances")
                        .HasForeignKey("FlowId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Requester")
                        .WithMany()
                        .HasForeignKey("RequesterId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Flow");

                    b.Navigation("Requester");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.BreakGlassAccess", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Reviewer")
                        .WithMany()
                        .HasForeignKey("ReviewedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("USP.Core.Models.Entities.PrivilegedSession", "Session")
                        .WithMany()
                        .HasForeignKey("SessionId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Reviewer");

                    b.Navigation("Session");

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.BusinessAssociateAgreement", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "LastReviewedByUser")
                        .WithMany()
                        .HasForeignKey("LastReviewedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("LastReviewedByUser");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ComplianceControl", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "AssessedByUser")
                        .WithMany()
                        .HasForeignKey("AssessedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("USP.Core.Models.Entities.ComplianceReport", "Report")
                        .WithMany("Controls")
                        .HasForeignKey("ReportId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("AssessedByUser");

                    b.Navigation("Report");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ComplianceReport", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "GeneratedByUser")
                        .WithMany()
                        .HasForeignKey("GeneratedBy")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("GeneratedByUser");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.DatabaseLease", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.DatabaseConfig", "DatabaseConfig")
                        .WithMany("Leases")
                        .HasForeignKey("DatabaseConfigId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.DatabaseRole", "DatabaseRole")
                        .WithMany("Leases")
                        .HasForeignKey("DatabaseRoleId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("DatabaseConfig");

                    b.Navigation("DatabaseRole");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.DatabaseRole", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.DatabaseConfig", "DatabaseConfig")
                        .WithMany("Roles")
                        .HasForeignKey("DatabaseConfigId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("DatabaseConfig");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.FlowApproval", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Approver")
                        .WithMany()
                        .HasForeignKey("ApproverId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.AuthorizationFlowInstance", "FlowInstance")
                        .WithMany("Approvals")
                        .HasForeignKey("FlowInstanceId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Approver");

                    b.Navigation("FlowInstance");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.JitAccess", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.AccessApproval", "Approval")
                        .WithMany()
                        .HasForeignKey("ApprovalId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "RevokedByUser")
                        .WithMany()
                        .HasForeignKey("RevokedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("USP.Core.Models.Entities.JitAccessTemplate", "Template")
                        .WithMany("AccessGrants")
                        .HasForeignKey("TemplateId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Approval");

                    b.Navigation("RevokedByUser");

                    b.Navigation("Template");

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.LdapConfiguration", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Creator")
                        .WithMany()
                        .HasForeignKey("CreatedBy")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.MagicLink", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.MfaBackupCode", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany("MfaBackupCodes")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.MfaDevice", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany("MfaDevices")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.OAuth2AuthorizationCode", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.OAuth2Client", "Client")
                        .WithMany("AuthorizationCodes")
                        .HasForeignKey("ClientId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Client");

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PkiCertificateAuthority", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.PkiCertificateAuthority", "ParentCa")
                        .WithMany()
                        .HasForeignKey("ParentCaId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("ParentCa");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PkiIssuedCertificate", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.PkiCertificateAuthority", "CertificateAuthority")
                        .WithMany("IssuedCertificates")
                        .HasForeignKey("CertificateAuthorityId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.PkiRole", "Role")
                        .WithMany()
                        .HasForeignKey("RoleId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.Navigation("CertificateAuthority");

                    b.Navigation("Role");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PkiRole", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.PkiCertificateAuthority", "CertificateAuthority")
                        .WithMany()
                        .HasForeignKey("CertificateAuthorityId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("CertificateAuthority");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedAccount", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.PrivilegedSafe", "Safe")
                        .WithMany("Accounts")
                        .HasForeignKey("SafeId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Safe");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedSafe", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Owner")
                        .WithMany()
                        .HasForeignKey("OwnerId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Owner");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedSession", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.AccountCheckout", "Checkout")
                        .WithMany()
                        .HasForeignKey("AccountCheckoutId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.PrivilegedAccount", "Account")
                        .WithMany()
                        .HasForeignKey("AccountId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Account");

                    b.Navigation("Checkout");

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.RiskAssessment", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.RolePermission", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.Permission", "Permission")
                        .WithMany("RolePermissions")
                        .HasForeignKey("PermissionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.Role", "Role")
                        .WithMany("RolePermissions")
                        .HasForeignKey("RoleId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Permission");

                    b.Navigation("Role");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.SamlIdentityProvider", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Creator")
                        .WithMany()
                        .HasForeignKey("CreatedBy")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.Role", "DefaultRole")
                        .WithMany()
                        .HasForeignKey("DefaultRoleId")
                        .OnDelete(DeleteBehavior.SetNull);

                    b.Navigation("Creator");

                    b.Navigation("DefaultRole");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Secret", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Creator")
                        .WithMany("CreatedSecrets")
                        .HasForeignKey("CreatedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.SecretAccessLog", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Accessor")
                        .WithMany("SecretAccessLogs")
                        .HasForeignKey("AccessedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("USP.Core.Models.Entities.Secret", "Secret")
                        .WithMany("AccessLogs")
                        .HasForeignKey("SecretId")
                        .OnDelete(DeleteBehavior.Cascade);

                    b.Navigation("Accessor");

                    b.Navigation("Secret");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Session", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany("Sessions")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.SessionCommand", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.PrivilegedSession", "Session")
                        .WithMany("Commands")
                        .HasForeignKey("SessionId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Session");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.TransitKey", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Creator")
                        .WithMany()
                        .HasForeignKey("CreatedBy")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.Navigation("Creator");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.TransitKeyVersion", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Creator")
                        .WithMany()
                        .HasForeignKey("CreatedBy")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.TransitKey", "TransitKey")
                        .WithMany("Versions")
                        .HasForeignKey("TransitKeyId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Creator");

                    b.Navigation("TransitKey");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.TrustedDevice", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany("TrustedDevices")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.UserClearance", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "GrantedByUser")
                        .WithMany()
                        .HasForeignKey("GrantedBy")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "LastReviewedByUser")
                        .WithMany()
                        .HasForeignKey("LastReviewedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("GrantedByUser");

                    b.Navigation("LastReviewedByUser");

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.UserRiskProfile", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.UserRole", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "GrantedByUser")
                        .WithMany()
                        .HasForeignKey("GrantedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("USP.Core.Models.Entities.Role", "Role")
                        .WithMany("UserRoles")
                        .HasForeignKey("RoleId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany("UserRoles")
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("GrantedByUser");

                    b.Navigation("Role");

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WebAuthnCredential", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Webhook", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("User");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WebhookDelivery", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.Webhook", "Webhook")
                        .WithMany("Deliveries")
                        .HasForeignKey("WebhookId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Webhook");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Workspace", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Owner")
                        .WithMany()
                        .HasForeignKey("OwnerId")
                        .OnDelete(DeleteBehavior.Restrict)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.Workspace", "ParentWorkspace")
                        .WithMany("ChildWorkspaces")
                        .HasForeignKey("ParentWorkspaceId")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.Navigation("Owner");

                    b.Navigation("ParentWorkspace");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WorkspaceMember", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "Inviter")
                        .WithMany()
                        .HasForeignKey("InvitedBy")
                        .OnDelete(DeleteBehavior.Restrict);

                    b.HasOne("USP.Core.Models.Entities.ApplicationUser", "User")
                        .WithMany()
                        .HasForeignKey("UserId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("USP.Core.Models.Entities.Workspace", "Workspace")
                        .WithMany("Members")
                        .HasForeignKey("WorkspaceId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Inviter");

                    b.Navigation("User");

                    b.Navigation("Workspace");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WorkspaceQuota", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.Workspace", "Workspace")
                        .WithOne("Quota")
                        .HasForeignKey("USP.Core.Models.Entities.WorkspaceQuota", "WorkspaceId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Workspace");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.WorkspaceUsage", b =>
                {
                    b.HasOne("USP.Core.Models.Entities.Workspace", "Workspace")
                        .WithOne("Usage")
                        .HasForeignKey("USP.Core.Models.Entities.WorkspaceUsage", "WorkspaceId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Workspace");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AccessApproval", b =>
                {
                    b.Navigation("Checkouts");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ApplicationUser", b =>
                {
                    b.Navigation("ApiKeys");

                    b.Navigation("AuditLogs");

                    b.Navigation("CreatedSecrets");

                    b.Navigation("MfaBackupCodes");

                    b.Navigation("MfaDevices");

                    b.Navigation("SecretAccessLogs");

                    b.Navigation("Sessions");

                    b.Navigation("TrustedDevices");

                    b.Navigation("UserRoles");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AuthorizationFlow", b =>
                {
                    b.Navigation("FlowInstances");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.AuthorizationFlowInstance", b =>
                {
                    b.Navigation("Approvals");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.ComplianceReport", b =>
                {
                    b.Navigation("Controls");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.DatabaseConfig", b =>
                {
                    b.Navigation("Leases");

                    b.Navigation("Roles");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.DatabaseRole", b =>
                {
                    b.Navigation("Leases");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.JitAccessTemplate", b =>
                {
                    b.Navigation("AccessGrants");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.OAuth2Client", b =>
                {
                    b.Navigation("AuthorizationCodes");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Permission", b =>
                {
                    b.Navigation("RolePermissions");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PkiCertificateAuthority", b =>
                {
                    b.Navigation("IssuedCertificates");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedAccount", b =>
                {
                    b.Navigation("Checkouts");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedSafe", b =>
                {
                    b.Navigation("Accounts");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.PrivilegedSession", b =>
                {
                    b.Navigation("Commands");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Role", b =>
                {
                    b.Navigation("RolePermissions");

                    b.Navigation("UserRoles");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Secret", b =>
                {
                    b.Navigation("AccessLogs");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.TransitKey", b =>
                {
                    b.Navigation("Versions");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Webhook", b =>
                {
                    b.Navigation("Deliveries");
                });

            modelBuilder.Entity("USP.Core.Models.Entities.Workspace", b =>
                {
                    b.Navigation("ChildWorkspaces");

                    b.Navigation("Members");

                    b.Navigation("Quota");

                    b.Navigation("Usage");
                });
#pragma warning restore 612, 618
        }
    }
}
